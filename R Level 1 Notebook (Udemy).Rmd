---
title: "R Level 1"
author: "KM"
date: "2018蟷<ef>??1??<9b><88>5譌･"
output:
  html_document: default
  pdf_document: default
  word_document: default
---

# Section 1
## Lecture 3: 

R: programming language
RStudio: GUI (Graphical User Interface)
- click interface
- execute basic commands without code
- accelerate general tasks
- open soruce version for the individual user is available

RCmdr (R Commander)
- focues on a few topics like statistics and graphics
- mainly relies on R Base
- less user-friendly

```{r}
myfirstobject=5:10
plot(myfirstobject)
```

## Lecture 4: Structure of R

The key traits of R
- open-source, high level programming languges used for data analytics purpses. 
 - data entry
 - data pre-processing
 - statistical analysis (modeling, machine learning, prediction)
 - data simulations
 - data visualization
 - web scraping 
 - data visualization for website integration (Shiny)
 
Alternative tools
 - Matlab:engineering
 - Minitab:quality control, six sigma
 - SAS: clinical research, drug development
 - SPSS: academia (social science)

How to work with add-on packages

## Section 1 - Lecture 6: Basic Commands 
### Understanding Functions in R
Setting a seed to make a random sample reproducible, choose any number you want set.seed(65)
```{r}
# with argument name, exact argument order 
set.seed(65)
runif(n = 9, min = 3, max = 6)
# without argument name, exact argument order 
runif(9, 3, 6)
set.seed(65)
# with argument name, mixed argument order 
runif(min = 3, max = 6, n = 9)
set.seed(65)
# without argument name, mixed argument order 
runif(3, 6, 9) # this means n=3, max=9
set.seed(65)
# using only the first argument 
runif(3)
set.seed(65)
# using arguments 1 and 3 
runif(3,,4)
```

### First Coding Steps
complicated codes, sntax erros, faulty codes, typos... , but there are three common mistakes.

(1) Download and activate packages
(2) Case sensitivity
(3) Concatenation

### Object
A data object is a collection of data you want to be used as one. 
- whole dataset
- result of a calculation
- a part of a dataset with specific traits

Different object propertieis/classes determine what we can/cannot od with the data

Classic object class: "data.frame"
- columns for variables
- rows for observsation

Simplest object class vector: vector
- a collection of values of the same class
  - vector+date=time series data/"ts"
  - integfer vector: contains only integer

c() is a contatenation which accomodates values withing the brackets belonging together.

```{r}
# R as a calculater
4 + 4 + 5
# Space does not matter
# Operators: + - / * ^
# Using several operators and round brackets (5-3)^3
# Creating objects x <- c(4,5,6)

# arrows work both directions y
y<-c(4,5.2,76)
c(4,5.2,76)->y
x = c(4, 5, 6)
assign("x", c(4.2, 1, 5)) # function assign

# c for concatenate
x = c(4,5,6)
x # display in console

# semicolon indicates a new row of code
x = c(4,5,6); x 

# See which objects are already created ls()
objects()

# Removing an object 
rm("x")

# Working with vectors 
x = c(y, 5, y) 
x
 nnnnnnnnn   # Sum and roots sum(x)
sqrt(x)

# Values at a given position within the vector 
x[1]

newobject <- x < 5; newobject

# Comparison against original values
x 
```

### Types of brackets
- () round brackets as the standard
 - the standard, mainly used form
 - bind values together witihn a function or an object
 - pre-defined functions use this type of brackets
- [] box brackets for index positions
 - used for data filtering
 - indicate the index position within an object
  - in vector: single value
  - in data frame: row or column
- {} curled brackets for functions and loops
  - used within self-designed functions

### Features of R Functions
a: order of arguments matters.
b: Some of arguments are mandatory, while others are optional.

### Functions: seq, paste, rep
#### sequence() function 
```{r}
# starting with the seq function
?seq 

# just using the default settings
seq()

# simple sequence from 3 to 5 seq(3, 5)
seq(from = 3, to = 5)

# using length 
seq(from = 3, length = 3)

# step manipulations 
seq(from = 3, length = 3, by = 0.5)

# changed order
seq(from = 3, by = 0.5, length = 3) 
```

#### Paste() function

```{r}
?paste
paste(1:4)

# checking the class
class(paste(1:4)) 
paste("xyz", 1:10)

# random vector with numbers and characters
paste("xyz", c(2,5,7,"test", 4.5))
# modifying the seperator
paste("xyz", 1:10, sep = "") 
```

```{r}
?rep 
rep(c(3,4,5), 3)
rep(1:10, times = 3)

x = c(1,2,3) # creating x
# using each
rep(x, each = 3) 
# combining arguments
rep(x, each = 3, times = 3) 

## Working with index positions
x = 4:20

# double equal sign, logical operation
which(x == 10) 
x[3]
```

### Exercise
```{r}
# 1 . Create the object "myobject" and assign the values 1:10 # in at least 3 different ways
myobject<-(1:10)
myobject
assign("myobject", 1:10)
myobject

# 2. Get the sum of your object
sum(myobject)

# 3. Create the following vector by using the paste function "R is great 4 and I will love it" "R is great 7 and I will love it" "R is great 45 and I will love it"
paste("R is great", c(4,7,45),"I will love it")

# 4. vector of 1,2,3 : repeat the vector to get 11 x 1, 10 x 2, and 10 x 3
x<-c(1,2,3)
x2<-x*c(11,10,10)
x2
x=rep(1:3,length=31);x

# 5. What is the value of this vector on position 7
x[7]
```

### Working with data.frames
```{r}
?airmiles
head(airmiles) # first 6 rows
tail(airmiles) # last 6 rows

?mtcars
summary(mtcars)

```


# simple xy plot function of R Base
```{r}
plot(mtcars) 
hist(airmiles) # histogram
head(mtcars)
```

We need to set which data.frame to use for sum function.
```{r}
# sum() function application
sum(mtcars$wt)

# attach to R session environment
attach(mtcars) 
# now R knows which data.frame to use since it is attached
sum(wt) 
# remove it from environment
detach(mtcars) 

# error message since mtcars it not attached any more
sum(wt)

# indext position by box bracket
mtcars[2,6]
mtcars[c(2,5,8),6]
```

### Graphs in R Base
There are three gears of plotting in R.
1. R Base - default
- classic R syntax
- quick on standard task (plot, hist, boxplot, barplot)

2. Lattice
- appropriate for scientific publication
- syntax is similar to R base
- plot matrix

3. ggplot by Hadley Wickham
- sub-language with own syntax
- is getting the standard way of data visualization

```{r}

# 3 main data viz systems: 
# ggplot2, lattice and R Base


# simple scatterplot
x=5:7 # 3 data points, integers 
y=8:10

# default plot output here is a scatterplot 
plot(x,y)

# data is a time series, default here is a line plot 
?lynx
plot(lynx)

# title, color, title color, title magnification 
## cex.main: magnification 
plot(lynx, main="Lynx Trappings", col="red",col.main=52, cex.main=1.5)

# label names 
plot(lynx, ylab="Lynx Trappings", xlab="")

# label orientation
plot(lynx, ylab="Lynx Trappings", xlab="", las=2)

# las - 0:3, scale orientation

# changing the session paramter, 2*2 plot matrix 
par(mfrow=c(2,2), col.axis="red")

plot(1:8, las=0, xlab="xlab", ylab="ylab", main="LAS = 0") 
plot(1:8, las=1, xlab="xlab", ylab="ylab", main="LAS = 1") 
plot(1:8, las=2, xlab="xlab", ylab="ylab", main="LAS = 2") 
plot(1:8, las=3, xlab="xlab", ylab="ylab", main="LAS = 3")

# color manipulation
colors()

# point symbol types
?pch

x=2:4
plot(x, pch="c") # using letters as point symbols
plot(x, pch=13) # symbol nr 13

# Line Types

# setting parameters back to default
par(mfrow=c(1,1), col.axis="black") 

# add on package for "ablineclip", install if not yet available
install.packages("plotrix")
library(plotrix) 

# test plot
plot(1:7, ylab="", main="Line Types lty 0:6", xlab="lty 0:6") 

## ?X???? (trend line)?̒ǉ?
ablineclip(v=1, lty=1, col="sienna2", lwd=2) 
ablineclip(v=2, lty=2, col="sienna2", lwd=2) # dashed 
ablineclip(v=3, lty=3, col="sienna2", lwd=2) # dotted 
ablineclip(v=4, lty=4, col="sienna2", lwd=2) # dotdash 
ablineclip(v=5, lty=5, col="sienna2", lwd=2) # longdash 
ablineclip(v=6, lty=6, col="sienna2", lwd=5) # twodash, thicker for comparison 
ablineclip(v=7, lty=0, col="sienna2", lwd=2) # blank

# plot types of R Base plot
? plot

# by using "type" we can specify which kind of plot we want
plot(lynx) # plot for time series data

plot(lynx, type="p", main="Type p") # points (default) 
plot(lynx, type="l", main="Type l") # lines (default for time series) 
plot(lynx, type="b", main="Type b") # points connected by lines 
plot(lynx, type="b", main="Type c") # lines only of b 
plot(lynx, type="o", main="Type o") # points overlaid by lines 
plot(lynx, type="h", main="Type h") # high density 
plot(lynx, type="s", main="Type s") # steps 
plot(lynx, type="n", main="Type n") # no plot
```

### Example: advanced line plot with R Base
```{r}
# change of plot margins
par(mar=c(4,3,3,3), col.axis="darkgreen")

# adding the explanatory text to plot 1
plot(cars$speed, type="s", col="red", bty="n", xlab="Cars ID", ylab="") 
text(8, 14, "Speed in mph", cex=0.85, col="red") 

par(new=T) # allows 2 in 1 plot

plot(cars$dist, type="s", bty="n", ann=F, axes=F, col="darkblue") axis(side=4, col = "darkblue") 
# y axis for plot 2 text(37, 18, "Stopping distance in ft", cex=0.85, col="darkblue") # explanations to plot 2 title(main="Speed and Stopping\n Distances of Cars") # main title

#??? graphical parameters
?par
par()
```

### Graphs Exercise
```{r}
# 1. get familiar with "rivers" - how many observations? 
# 2. plot rivers against its index (hint: number of observation on x) 
# 3. add: header (red), label names 
# 4. change the point symbol and point color
?rivers


## Solution
?rivers # 141 observations
x = 1:141
y = rivers
plot(x,y, col = "green", pch = 20,      main = "Lengths of\nMajor N. American Rivers",      col.main ="red", xlab = "",      ylab = "length in miles")
```

# section 2: Basics
## Lecture 20: Object types
### Vector
A vector has one dimension and one type of data.
```{r}
myvector<-c(1,1:10)
myvector
length(myvector)
mode(myvector)
class(myvector)
typeof(myvector)
```

### Matrix 
A matrix has two dimensions and one type of data.
```{r}
mymatrix<-matrix(1:10,nrow=2)
length(mymatrix)
mode(mymatrix)
class(mymatrix)
typeof(mymatrix)
```

### Array
has two matrix or more dimensions and one type of data
```{r}
myarray<-array(1:3,dim=c(3,3,3))
myarray
length(myarray)
mode(myarray)
class(myarray)
typeof(myarray)
```

### Data.frame
A data frame is a set of data with different data types, and known as a simplest way to explain. 
```{r}
view(iris)
length(iris)
mode(iris)
typeof(iris)
```

### List
IS a collection of different objects, different data types are possible and common.
```{r}
myList<-list(a=mymatrix, b=myvector)
length(myList)
class(myList)
```

## Lecture 22: Data Types 

There are different ways in which to specify the data types in R. The most important data types are mode and typeof. 
- Mode (storage mode)
  - Example: logical, numeric, compex, character, list,function
    - atomic: logical numeric, complex character
    - recursive: list, function
- Typeof
  - logical, integer, double (like numeric), complex, character, list, closure

```{r}
a = (1:5)
b = rep(1.45,3)
c = c("wed", "tue", "sat")
d = c(1+7i,2+4i)
e = c(T,T,F,F)
fun = function(x) {x+3}
a
mode(a)
typeof(a)

b
mode(b)
typeof(b)

c
mode(c)
typeof(c)

d
mode(d)
typeof(d)

e
mode(e)
typeof(e)
fun

e
f = as.character(e)
f
mode(fun)
typeof(fun)
```

### Lecture 24: Random Number Generation

```{r}
# Normal distribution
rnorm(100, mean=3)
y<- rnorm(100,mean=3)
hist(y)

# default is mean=0, sd=1
rnorm(10)

# Poission distribution
rpois(100, lambda=3)

# Uniform distribution
runif(100)

# to give you a little overview of this distributions
hist(rnorm(1000))
hist(runif(1000))
hist(rpois(1000, 3))
# using set.seed to fix the number generator
set.seed(45)
rnorm (10)
# there is a variety of random generators
# rng.kind argument in set.seed to change the generator
```

Extercises
```{r}
# 1 Get 100 random numbers which are uniformly distributed. Thesebnumbers should be between 1 and 100
x<-runif(100,1,100)

# 2get a vector from this random numbers consisting of every tenth value
x[seq(from=10,by=10,length=10)]


# 3 Find out what the argument la bda in rpois by manipulating it
#lambda speficfies the center of distribution
y<-rpois(1000,lambda=3)
hist(y)

rm(x,y)
```

### Lecture 25: How to export/import of excel files

The best way to do this is via csv files
<- comma separeted values
imporant when importing to excel

```{r}
#To import a csv import
a=1:4
b=c("a","b","c","d")
testdf=cbind(a,b)

# create and store a csv file in the wd:
write.csv(testdf,file="testdf.csv")

# Import a csv file
?read.csv
myImport<-read.csv(file.choose(),header=T)

# read table is a more general approach
myImport2<-read.table(file.choose(),header=T)

# You have to specify the separater
myImport3<-read.table(file.choose(),header=T,sep=",")

# Text file - read.delim
rm(a,b,testdf)
```

#Section 3: Creating objects
## Lecture 30: Matrices (Part1)
```{r}
matrix(c(1,2,3,4,5,6))

# let's see the default settings
?matrix
# number of rows
matrix(c(1,2,3,4,5,6),nrow=2)
# number of columns
matrix(c(1,2,3,4,5,6),ncol=2)
# make sure to have an even number of values
matrix(c(1,2,3,4,5),nc=2)
# identify rows and columns
matrix(c(1,2,3,4),nrow=2,ncol=2, dimnames = list(c("R-1","R-2"),c("C-1","C-2")))

# create a diagonal matrix
x=1:3
diag(x)

Y=diag(x)
Y

# transpose matrix
w <- matrix(c(2,4,8,12),nr=2,nc=2)
w
t(w)

rm(x,w)
```

## Lecture31: Matrices(Part2)
```{r}
# Get the inverse of a matrix
solve(w)

# multiply matrices
c<-matrix(c(5,7,8,9),nr=2)

# get the cross-product
crossprod(w)

# multiply a matrix with a vector
x=1:3
Y=x # dimension check

# solving equation systems
solve(y,x)
```

## Lecture 32: Matrices(excercize)
```{r}
# 1. create the matrix
x=matrix(c(rep(7,3),rep(-7,3),rep(7,3)),nr=3,nc=3,byrow=T,dimnames(list(c("r-1","r-2"),c("c-1","c-2","c-3"))))
# 2. name columns and rows

t(x)*x
crossprod(x)/3
```

## Lecture 35: Lists in R
How to create lists in R.
```{r}
mylist<-list(1:10,c("Tom","Mike","Frank"),rnorm(10))
mylist

names(mylist)<-c("myInteger","myChacter","myNumeric")

# Length of a single elements
length(mylist$myInteger)

# directly name the elements 
mylist2<-list(a=3:5,b=c(4,6,4,9))
mylist2

# work with specific ements of the list
mylist$myChacter
mylist$myChacter[2]

# get the model of the elements
mode(mylist$myNumeric)
mode(mylist$myChacter)

# we can even combine our 2 lists 
combinelist<-c(mylist2, mylist)
combinelist
```

### Excercize
```{r}
# 1 create a list of three elements with three different classes

# 2 extract the value on position 2 of your 2 element in the list
a=c("Hungary", "Italy","Netherland")
b=(rnorm(10))
c=30:45

myexlist=list(a=a,b=b,c=c)
myexlist
myexlist$b[2]

```

## Lecture 38-39: Data Frame Part 1/Part2
Two dimensional objects with different data types
Very useful tool in R
- row: observation
- column: variable

```{r}
?mtcars
mtcars
```


```{r}
country=c("Italy","France","India","Canada")
name=c("tom","Sue","Mike","Jane")
bheight=c(1.87,1.67,1.77,1.76)
bmi=c(23,27,29,21)

# Create a data frame out of several vectors 
survey<-data.frame(country,name,bheight,bmi)
survey

# Add a new vector to an existing data frame
newvec=c(F,T,T,F)
newsurvey<-cbind(survey,newvec)
newsurvey

# Extract a vector out of the data frame
mtcars
mtcars$cyl

# or we can use the attach function
cyl
attach(mtcars)
cyl

# extract a single entry
mtcars

mtcars[2,2]
# extract a row
mtcars[2,]
# extract a column
mtcars[,2]

# logically filter parts of the data set
require(magrittr)

attach(mtcars)
cyl<5

# filter for a subset of data which meets the criteria
mtcars[cyl<5,]

# we can even specify the output columns we want
mtcars[cyl<5,c("mpg","cyl","wt")]

```

## Lecture 40: Factors
Factors can help you to store character data by using factors it is easier to perform calculations. Seome commands require factors to be executed. 

```{r}
iris

iris$Species
# the prolem is that is is sometimes inefficient to handle long characters
# solution: create a vector of factors

as.integer(iris$Species)
new

# factors can be stored as integers - quite handy
FactorSP=as.integer(iris$Species)
newiris=cbind(iris,FactorSP)
newiris

```

## Lecture 40: Exercises for data frame
Get familiar with the dataset iris.
For futher convicnence, I recommend to attach this dataset. 
Learn more about the last column species - how many species are there?

```{r}
attach(iris)
head(iris)
summary(iris$Species)
```


Let us assume we are only interested in the species virginica
- create a logical vector (myFilter) with virginica is T, otherwiseF
- add it to the data frame and call it newiris

```{r}
myFilter=as.integer(iris$Species)
myFilter

myFilter=(Species=="virginica")
myFilter

newiris<-cbind(iris,myFilter)
newiris

```


Create the data frame virginica.s which consists of: 
- sepal.Length and sepal.width of the newiris dataset
```{r}
newirisext<-newiris[,c("Sepal.Length","Sepal.Width")
newirisext

virginica.s=newiris[myFilter==T, c("Sepal.Length","Sepal.Width")]
virginica.s
```


Check the class of this new data frame.
```{r}
class(newirisext)
```

# Section 4: Functions in R
## Lecture 44: Introduction to Functions in R

Brief description - R functions are objects
they do calculations for your

R function struture: name function (argument)
They arguments specify the components to be used in the function

```{r}
myfirstfn<-function(x){x+x}
myfirstfn(10)
```

### Stepwise working functions
```{r}
mysecondfn<-function(t,z){
  value=z*3
  value=value*t
  print(value)}

t=5
z=9

mysecondfn(t,z)

```

In this case, the object "value" was used as a stepwise within the function.

Triple dots can be used as a place holder, for any argument to be used open ended.
```{r}
testfunction<-function(...){
mydataframe=data.frame(cbind(...))
print(mydataframe)}

# lets create some vectors
a=(4:7)
b=c("a","g","h","w")

testfunction(a,b)
# as you can see it is a data frame, every row is numbered

# and you can use the function in any way you want as long as the vectors 
c=c(4.6,5.5,8.9,11.3)
testfunction(c,b)
```

## LEcture 46: Ifelse function







