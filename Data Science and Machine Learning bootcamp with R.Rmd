

# R for Data Science and Machine Learning
## Section 6
### Lecture 11: Course notes 
### Lecture 12: Guide to RStudio
### Lecture 13: Introduction to R Basics 
### Lecture 16: Basic data types 

```{r}
# lecture 25: Creating a matrix 

goog <- c(450,451,452,445,468)
msft <- c(230,231,232,233,220)
stocks <- c(goog,msft)
stocks.matrix=matrix(stocks,byrow=T,nrow=2)
stocks.matrix

days <- c('Mon', 'Tue', 'Wed', 'Thu', 'Fri')
st.names <- c("goog","msft")

colnames(stocks.matrix) <- days
rownames(stocks.matrix) <- st.names
print(stocks.matrix)
```

# Section 8
## Lecture 26: Matrix
```{r}
# matrix 
mat <- matrix(1:25,byrow=T,nrow=5)
mat
mat*2
mat/2
mat^2

mat[,c(1,2)]

mat*mat
mat %*% mat
```

## Lecture 27: Matrix operation

```{r}
goog <- c(450,451,452,445,468)
msft <- c(230,231,232,233,220)

stocks <- c(goog,msft)

stocks.matrix=matrix(stocks,byrow=T,nrow=2)
stocks.matrix

days <- c('Mon', 'Tue', 'Wed', 'Thu', 'Fri')
st.names <- c("goog","msft")

colnames(stocks.matrix) <- days
rownames(stocks.matrix) <- st.names
print(stocks.matrix)
```

By using the above stock matrix, we practive matrix operations. 
```{r}
# sum calculation
colSums(stocks.matrix)
rowSums(stocks.matrix)

# row means calculation
rowMeans(stocks.matrix)

# rbind - FB was used as a new row name
FB <- c(111,112,113,120,145)
tech.stocks <- rbind(stocks.matrix,FB)

avg <- rowMeans(tech.stocks)
avg

tech.stocks <- cbind(tech.stocks,avg)
tech.stocks

```

## Lecture28: Matrix selection and indexing
```{r}
mat <- matrix(1:50,byrow=TRUE,nrow=5)
mat[1,]
mat[,]
mat[1:3,]
```

## Lecture29: Factors and categorical matrices

- Nominal categorical - no order
- Ordinal categorical - order

```{r}
animal <- c('d','c','d','c','c')
id <- c(1,2,3,4,5)

# character class -> factor
class(animal)
factor(animal)

# factor 
fact.ani <- factor(animal)
ord.cat <- c('cold','med','hot')
temps <- c('cold','med','hot','hot','hot','cold','med')
temps
summary(temps)

# factor level 
fact_temp <- factor(temps,ordered=TRUE,levels=c('cold','med','hot'))
fact_temp
summary(fact_temp)

```


## Lecture30: Matrix exercises 
```{r}
# R Basic Exercise
#1. two to the power of five
2^5
#2 stock price vector/matrix
stock.prices=c(23,27,23,21,34)
stock.prices
#3 matrix row name
stock.prices=matrix(c(23,27,23,21,34))
rownames(stock.prices)=c("Mon","Tues","Wed","Thu","Fri")
stock.prices
#4 average(mean) computation
mean(stock.prices[,1])
colMeans(stock.prices)
#5. 
over.23 <- stock.prices>23
stock.prices[over.23]

max(stock.prices)
max.price <- stock.prices==max(stock.prices)
max.price

stock.prices[max.price]
```

```{r}
# R Matrix Exercises
# Ex 1: 
require(magrittr)
A <- c(1,2,3) %/% print(A)
B <- c(4,5,6) %/% print(B)

mat <-matrix(A,byrow=T,nrow=1)
matrix <- cbind(mat,B)
matrix <- rbind(mat,B)

rownames(matrix) <- c("A","B")

# Ex 2:
mat <- matrix(1:9,byrow=T,nrow=3)%/% print(mat)

# Ex 3:
is.matrix(mat)

# Ex 4:
mat2 <- matrix(1:25,byrow=T,nrow=5) 
print(mat2)

# Ex 5:
mat2[2:3,2:3]

# Ex 6:
mat2[4:5,4:5]

# Ex 7:
sum(mat2)
sum <- rowSums(mat2)
mat3 <- rbind(mat2,sum)
mat3
sum(mat3[6,])

# Ex 8:
help("runif")
ranmat <- matrix(dnorm(20),nrow=4,ncol=5)
ranmat2 <- matrix(runif(20,min=1,max=100),nrow=4)
ranmat2
```

# Section 9: Data Frame
## Lecture 33: Data Frame Basics
```{r}
head(state.x77)
class(state.x77)

state.x77.d <- data.frame(state.x77)
head(state.x77.d)
dim(state.x77.d)
summary(state.x77.d)
```

### simple data frame 
```{r}
days <- c("Mon","Tue","Wed","Thur","Fri")
temp <- c(22.2,21,23,24.3,25)
rain <- c(T,T,F,F,T)
df <- data.frame(days,temp,rain)
```

## Lecture34: data frame selection and indexing 
```{r}
# data frame overview
df
df[1,]

# column select by word
df[,'rain']
df[1:5,c('days','temp')]

## column select by $
df$days

# bracket notation
df['days']

# subset function
subset(df,subset=(rain==TRUE))
subset(df,subset=(temp>23.0))
subset(df,subset = temp>23.0)

sorted.temp <- order(df['temp'])
sorted.temp
df[sorted.temp,]

desc.temp <- order(-df$temp)
df[desc.temp,]
```

## LEcture35:Overview of data frame operations (Part1)

```{r}
empty <- data.frame()
empty

c1 <- 1:10

letters
c2 <- letters[1:10]

df <- data.frame(c1,c2)
df <- data.frame(colnames.1=c1,col.names.2=c2)
df
```

### read/write csv
```{r}
# read csv
write.csv(df,file='saved_df.csv')
df2 <- read.csv('saved_df.csv')
df2
```

### Getting information about data frame
```{r}
nrow(df)
ncol(df)
colnames(df)
rownames(df)
str(df)
summary(df)
```

```{r}
# change name of column
colnames(df) <- c("test1","test2")
df$test1

# refer specific row/column
df[[5,2]]
df[[5,'test2']]
df[[5,'test1']] <- 9999
df

df[1,]
```

mpgcars dataset 
```{r}
names(mtcars)
rownames(mtcars)
head(mtcars)

# get vector values in specific row/column
mtcars$mpg
mtcars[,'mpg']
mtcars[,1]

mtcars[['mpg']]

#data frame
mtcars['mpg']
mtcars[c("mpg","cyl")]
```

## Lecture36: Overview of data frame operations (Part2)

```{r}
df2 <- data.frame(test1=2000,test2="new")
df2

require(magrittr)
dfnew <- rbind(df,df2) %/% print(df)
df$newcol <- 2*df$test1

# copy columns
df$newcol.copy <- df$newcol %/% print(df)
df[,"newcol.copy2"] <- df$newcol %/% print(df)

# column names
colnames(df) <- c("1","2","3","4","5") %/% print(df)
df$`4` <- c(0,0,0,0,0,0,0,0,0,0)

df[1:10,]
df[1:3,]

# data frame head
head(df)
head(df,5)

# exclude specific rows/columns
df[-2,]

head(mtcars)
mtcars[mtcars$mpg>20,]

require(dplyr)
class(mtcars)

# filter / selection functions
mtcars2 <- filter(mtcars, mpg>20&cyl==6) 
select(mtcars,mpg)

mtcars[mtcars$mpg>20 & mtcars$cyl==6,]
mtcars[(mtcars$mpg>20)&(mtcars$cyl==6),c("mpg","cyl","hp")]
subset(mtcars,mpg>20&cyl==6)

head(mtcars)
mtcars[,c(1,2,3)]
is.na(mtcars)

# check any missing point
any(is.na(df))
any(is.na(mtcars$mpg))

df[is.na(df)] <- 0
mtcars$mpg[is.na(mtcars$mpg)] <- mean(mtcars$mpg)
```

## Lecture 37: Data Frames Training Exercises

Ex.1 Recreate data frame
```{r}
Age=c(22,25,26)
weight=c(150,165,120)
Sex=c("M","M","F")
df <- data.frame(Age,weight,Sex)
rownames(df) <- c("Sam","Frank","Amy") %/% print(df)
```

Ex.2 Check if mtcars is a dataframe using is.data.frame()
```{r}
class(mtcars)
is.data.frame(mtcars)
```

Ex.3 Use as data.frame() to convert a matrix into a dataframe
```{r}
mat <- matrix(1:25,ncol=5) %/% print(mat)
as.data.frame(mat)
mat
(mat_df <- data.frame(mat)) 
```

Ex.4 Set the built-in data frame mtcars as a variable df. We'll use this df variable for the rest of the excersize.
Ex.5 First 6 rows 
Ex.6 What is the average mpg value for all the cars
Ex.7 select the columns, am, gear and carb
Ex.8 create a new column called performance
Ex.9 2 decimal places by round()
Ex.10 average mgp for cars with more than 100hp and wt value more than 2.5
Ex.11 What is the mpg of the Hornet Sportabout?
```{r}
# Ex.7
(df <- mtcars)
head(df)
mean(mtcars$mpg)

# Ex.8
filter(mtcars, cyl==6)
mtcars[mtcars$cyl==6,]
mtcars[,c("am","gear","carb")]
mtcars$per <- df$hp/df$wt
head(mtcars)

# Ex.9
any(is.na(mtcars$per))
mtcars$per <- round(mtcars$per,2)
head(mtcars)

# Ex.10
mtcars3 <- subset(mtcars,hp>100,wt>2.5)
mean(mtcars3$mpg)

# Ex.11
df
df['Hornet Sportabout',]$mpg
```

# Section 10: List in R
## Lecture 39: List Basics
```{r}
v <- c(1,2,3)
m <- matrix(1:10,nrow=2)
df <- mtcars

class(v)
class(m)
class(df)

my.list <- list(v,m,df)
my.list
my.list[[1]]
class(my.list)

# list assignment with name
my.named.list <- list(sample.vec=v,my.matrix=m,sample.df=df)
my.named.list$sample.vec

double.list <- c(my.named.list,my.named.list)
double.list

str(my.named.list)
```

## Lecture 41: CSV files with R
```{r}
write.csv(mtcars,file="my.example.csv")
ex <- read.csv("my.example.csv")
ex

help(read.csv)
```

## Lecture 42: Excel files with R
```{r}
install.packages("readxl")
require(readxl)

# excel load
excel_sheets('C:/Users/kojiKM.mizumura/Desktop/Sample-Sales-Data.xlsx')
df <- read_excel('C:/Users/kojiKM.mizumura/Desktop/Sample-Sales-Data.xlsx',sheet="Sheet1")
head(df)
sum(df$Value)

entire.workbook <-lapply(excel_sheets('C:/Users/kojiKM.mizumura/Desktop/Sample-Sales-Data.xlsx'),read_excel,path='C:/Users/kojiKM.mizumura/Desktop/Sample-Sales-Data.xlsx')
entire.workbook

```

```{r}
install.packages("xlsx")
library(xlsx)
head(mtcars)
write.xlsx(mtcars,"output_example.xlsx")
```

## Lecture 43: SQL with R

Connecting R to SQL is actually simple - RODBC library

```{r}
install.packages("RODBC")
library(RODBC)

myconn <- odbcConnect("Database_Name",uid="User_ID",pwd="password")
data <- sqlFetch(myconn,"TableName")
querydat <- sqlQuery(myconn,"SELECT*FROM table")
close(myconn)
```

- MYSQL: 
The RMySQL package proides an intervace to MySQL
- Oracle:
The ROracle package provides an interface for Oracle
- JDBC: 
The RJDBC package procides access to database throught a JDBC database.

```{r}
install.packages("RPostgreSQL")
help(RPostgreSQL)
??RPostgreSQL
```


## Lecture 44: Web Scraping with R
HTML and CSS, pipe operator are required for understanding this lecture. 

rvest library
Below is a simple example of using rvest, but the best way to see a good demo of rvest is through the built-in demos by using:
- www.import.io

```{r}
demo(package="rvest")
demo(package="rvest",topic="tripadvisor")
```

Now if you are familiar with HTML and CSS a very useful library is rbest. Below we will go ver a simple example from RStudio. Imagine we would like to scrape some information about te Lego Movie from IMDB. We start by downloading and parsing the file with html():

```{r}
library(rvest)
lego_movie <- read_html("http://www.imdb.com/title/tt1490017/")
```

To extract the rating, we start with Seletor Gadget to figure out which css selector matches the data we want: strong span.Its the easiest way to determine which sleector extracts the data you are intersed in ). We use html_node to find the first noe that matches that selector, extract its contents with html_text(), and convert it to numeric with as.numeric():
```{r}
require(magrittr)
lego_movie %>% 
  html_node("strong span") %>%
  html_text() %>% 
  as.numeric
```

We use a similar process to extract the cast, using html_nodes() to find all nodes that match the selector: 

```{r}
lego_movie %>%
  html_nodes("#titleCast.itemprop span") %>%
  html_text()
```

The titles and authors of recent massage board postings are stored in the third table on the page. We can use html_node() and [[]] to find it, then coerce it to a data frame with html_table():
```{r}
lego_movie %>%
  html_nodes("table") %>%
  .[[3]] %>%
html_table()
```

# Section 12: R Programming
## Lecture 45: Introduction to programming basics
## Lecture 46: Logical operators 

```{r}
x <- 10
x < 5
x<20 & x>5
T & T

# OR logical operator
(x==10) | (x==100)
```

```{r}
df <- mtcars
df[df$mpg>20,]
df[(df$mpg>20) | (df$hp>100),]
df[(df$mpg>20) & (df$hp>100),]
```

## Lecture 47: If, else, and else if statemnts 

The structure of if statement is: 

if (Condition){
XXX (Code)
} else (condition){
xxx (Code)
}

Indentation is a key for Python. 
```{r}
# example 1
x <- 13
if (x==10){
  # code
  print("X is equal to 10!")
  } else if (x==12) {
  print("X equal to 12")
  }else{
      print("X was not equal to 10 or 12")
  }

# example 2
hot <- FALSE
temp <60

if (temp >80){
  # execute if condition was TRUE
  hot <- TRUE
} else {
  print("Temp is not greater than 80")
}
print(hot)

# example 3
ham <- 10
cheese <- 10
report <- "blank"

if(ham >= 10 & cheese >=10){
  report <- "Strong sales of both ham and cheese"
} else if (ham==0 & cheese==0){
  report <- "No sales today"
} else {
  report <- "we sold something today!"
}
print(report)

```

## Lecture 48: Conditional Statement Exercises

Ex 1.  write a script that will print "Even Number" if the variable is an even number otherwise print "Not Even"
```{r}
x <- 3

if (x %% 2 ==0){
  "Even Number!"
} else {
  "Not Even"
}
```

Ex 2. Write a script that will print "Is a Matrix" if the variable x is a matrix, otherwise print "Not a Matrix".
```{r}
x <- matrix()

if (is.matrix(x)==T){
  "Is a Matrix!"
} else {
  "Not a Matrix"
}
```

Ex 3. Create a script that given a numeric vector x with a length 3, will print out the elements in order from high to low. You must use, if, else if and else statements for logic (This code will be relatively long)
```{r}
x <- c(3,7,1)

if (x[1]>x[2]) {
  # first and second place
  fir <- x[1]
  sec <- x[2]
} else{
  fir <- x[2]
  sec <- x[1]
}

if (x[3] > fir & x[3] >sec){
  third <- sec
  sec <- fir
  fir <- x[3]
} else if (x[3] < fir & x[3] <sec){
  thi <- x[3]
} else {
  third <- sec
  sec <- x[3]
}

print(paste(fir,sec,thi))
```


Ex 4: Write a script that uses if,else if, and else statements to print the max element in a numeric vector with 3 elements.
```{r}
x <- c(20,10,1)
if (x[1]>x[2] & x[1]>x[3]){
  print(x[1])
} else if (x[2]>x[3]){
  print (x[2])
}else {
  print(x[3])
} 
```

## Lecture 50: While Loops 
while (condition){
code executed here 
while condition is true
}
```{r}
x <- 0
while(x<10){
  print(paste0("x is:",x))
  x <- x+1
  if(x==10){
    print("x is now equal to 10! Break Loop!")
    break
    print("Woo I printed too!")
  }
}
```

## Lecture 51: For loops
For loop structure
for (variable in vector){}

```{r}
v <- c(1,2,3,4,5)

for (temp.var in v){
  # execute some code
  # for every temp.var in v
  print("Hello")
  #print(temp.var)
}

for (temp.var in v){
  result <- temp.var+1
  print("The temp.var plus 1 is equal to:")
  print(result)
}

# list operation
my.list <- list(c(1,2,3),mtcars,12)
for (item in my.list){
  print(item)
}

# matrix operation
mat <- matrix(1:25, nrow=5)
print(mat)

for (num in mat){
  print(num)
}  

for (row in 1:nrow(mat)){
  for (col in 1:ncol(mat)){
    print(paste("The selected row is ]",row))
    print(paste("The element at row:",row,"and col:",col,"is",mat[row,col]))  
    }
}
```

## Lecture 52: Functions

```{r}
# Basic sntax of function
name_of_func <- function(inputs1,inputs2,inputs3=45){
  # code execute
  return(result)
}

hello <- function(name){
  print(paste("Hello",name))
}
hello("Sammy")
hello()

add_num <- function(num1, num2){
  print(num1+num2)
}
add_num(4,5)

result <- add_num(4,5)
print(result)

# function "times5"
times5 <- function(num){
  my.result <- num*5
  return(my.result)
  #return(num*5)
}
times5(5)

# function "fun"
v <- "I'm a global variable"
stuff <- "I'm global stuff"

fun <- function(stuff){
  print(v)
  stuff <- "Reassign stuff inside of this function fun"
  print(stuff)
}
fun(stuff)


```

## Lecture 53: Functions Training Exercise
